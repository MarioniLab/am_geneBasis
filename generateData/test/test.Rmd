---
title: "Generating useable dataset for kidney."
output:
  BiocStyle::html_document:
    code_folding: hide
    number_sections: yes
    toc: yes  
---



```{r load, message = FALSE}
# load libraries we are going to use



library(SingleCellExperiment)
library(igraph)
library(batchelor)
library(stats)
library(BiocNeighbors)
library(tibble)
library(reshape2)
library(plyr)
library(dplyr)
library(scran)
library(batchelor)
library(stringr)
library(BiocSingular)
library(BiocParallel)

root.dir = "/nfs/research1/marioni/alsu/geneBasis/"
source(paste0(root.dir, "am_geneBasis/functions/main_functions.R"))
source(paste0(root.dir, "am_geneBasis/functions/visualization_functions.R"))

system = "melanoma"
# read sce 
sce = readRDS(paste0(root.dir , "data/scRNA_datasets/" , system , "/sce_" , system , ".Rds"))
sce = retain_only_hvgs(sce , n = 5000)

sim = generateSimilarity(sce, k = 50, batchFactor = factor(sce$sample), HVGs = rownames(sce))

```

#Session Info

```{r sessinf}
sessionInfo()
```
