---
title: "This script is to transform sce files to csvs, suitable for SCMER runs."
output:
  BiocStyle::html_document:
    code_folding: hide
    number_sections: yes
    toc: yes  
---

# Get csv format

```{r load, message = FALSE}

library(SingleCellExperiment)
set.seed(32)

root.dir = "/nfs/research1/marioni/alsu/geneBasis/data/"

# change for the relevant sce
#sce = readRDS(paste0(root.dir , "scRNA_datasets/atlas_E8.5/sce_atlas_E8.5.Rds"))
sce = readRDS(paste0(root.dir , "scRNA_datasets/spleen/sce_spleen_norm.Rds"))

# save to csv to run for SCMER
celltypes = unique(sce$celltype)
celltypes.num = sapply(sce$celltype , function(x) which(x == celltypes))
counts = as.matrix( counts(sce) )
counts.df = data.frame( rbind(sce$sample, as.numeric(celltypes.num) , counts) )
rownames(counts.df) = c("sample", "celltype" , rownames(sce))
write.csv(counts.df, file = paste0(root.dir, "4scmer/spleen/spleen.csv") , row.names = TRUE)


```



#Session Info

```{r sessinf}
sessionInfo()
```
